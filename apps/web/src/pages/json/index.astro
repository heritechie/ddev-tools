---
import BaseLayout from '../../layouts/BaseLayout.astro';
---
<BaseLayout title="JSON Formatter">
  <style>
    textarea {
      width: 100%;
      min-height: 180px;
      background: var(--bg-input);
      color: var(--text-main);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
      font-size: 14px;
      line-height: 1.5;
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
    }

    button {
      background: var(--bg-hover);
      color: var(--text-main);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px 12px;
      cursor: pointer;
    }

    button:hover {
      background: var(--bg-active);
    }

    button + button {
      margin-left: 8px;
    }

    pre {
      margin-top: 16px;
      background: #111;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 12px;
      white-space: pre-wrap;
      font-family: ui-monospace, monospace;
      font-size: 14px;
    }

    .error {
      margin-top: 12px;
      color: #ff6b6b;
    }

  </style>

  <h1>JSON Formatter</h1>

  <textarea
    id="input"
    placeholder='{ "hello": "world", "count": 1 }'
  ></textarea>

  <br />
  <button id="format">Format</button>

  <div id="result"></div>

  <!-- ðŸ‘‡ Client-side logic -->
  <script type="module">
    import { formatJson } from '/_core/format.js';

    const input = document.getElementById('input');
    const result = document.getElementById('result');
    const button = document.getElementById('format');

    button.addEventListener('click', () => {
      result.innerHTML = '';

      const value = input.value.trim();
      if (!value) return;

      const out = formatJson(value);

      if (!out.ok) {
        const p = document.createElement('p');
        p.className = 'error';
        p.textContent = 'Error: ' + out.error;
        result.appendChild(p);
        return;
      }

      const pre = document.createElement('pre');
      pre.textContent = out.formatted;
      result.appendChild(pre);
    });
  </script>
</BaseLayout>