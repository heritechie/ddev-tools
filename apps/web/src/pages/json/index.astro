---
import BaseLayout from '../../layouts/BaseLayout.astro';
---
<BaseLayout title="JSON Formatter">
  <h1>JSON Formatter</h1>

  <textarea
    id="input"
    placeholder='{ "hello": "world", "count": 1 }'
  ></textarea>

  <br />
  <button id="format">Format</button>

  <div id="result"></div>

  <!-- ðŸ‘‡ Client-side logic -->
  <script type="module">
    import { formatJson } from '/_core/format.js';

    const input = document.getElementById('input');
    const result = document.getElementById('result');
    const button = document.getElementById('format');

    button.addEventListener('click', () => {
      result.innerHTML = '';

      const value = input.value.trim();
      if (!value) return;

      const out = formatJson(value);

      if (!out.ok) {
        const p = document.createElement('p');
        p.className = 'error';
        p.textContent = 'Error: ' + out.error;
        result.appendChild(p);
        return;
      }

      const pre = document.createElement('pre');
      pre.textContent = out.formatted;
      result.appendChild(pre);
    });
  </script>
</BaseLayout>