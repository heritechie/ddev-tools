---
import BaseLayout from '../../layouts/BaseLayout.astro';
---
<BaseLayout title="JSON Formatter">
  <style>
    /* ===== Page-scoped styling (content only) ===== */

    h1 {
      margin-bottom: 20px;
    }

    label {
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 8px;
    }


    textarea {
      width: 100%;
      flex: 1;
      background: var(--bg-input);
      color: var(--text-main);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 14px;
      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
      font-size: 14px;
      line-height: 1.5;
      resize: none;
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
    }

    pre {
      flex: 1;
      background: #111;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 14px;
      font-family: ui-monospace, monospace;
      font-size: 14px;
      line-height: 1.5;
      white-space: pre-wrap;
      overflow: auto;
    }

    textarea,
    pre {
      margin: 0;
      box-sizing: border-box;
    }

    button {
      background: var(--bg-hover);
      color: var(--text-main);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      background: var(--bg-active);
    }

    .tool-panel {
      display: flex;
      flex-direction: column;
      min-height: 380px;
    }

    .tool-actions {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 12px;
      padding-top: 24px;
    }

    .tool-actions button {
      width: 100%;
      padding: 10px 12px;
    }

    .error {
      color: #ff6b6b;
    }

  </style>

  <h1>JSON Formatter</h1>

  <!-- ===== TOOL GRID ===== -->
  <div class="tool-grid">
    <!-- INPUT PANEL -->
    <div class="tool-panel">
      <label for="input">Input</label>
      <textarea
        id="input"
        placeholder='{ "hello": "world" }'
      ></textarea>
    </div>

    <!-- ACTIONS -->
    <div class="tool-actions">
      <button id="format">Format â†’</button>
    </div>
  
    <!-- OUTPUT PANEL -->
    <div class="tool-panel">
      <label>Output</label>
      <pre id="result"></pre>
    </div>
  </div>

  <!-- ðŸ‘‡ Client-side logic -->
  <script type="module">
    import { formatJson } from '/_core/format.js';

    const input = document.getElementById('input');
    const result = document.getElementById('result');
    const btn = document.getElementById('format');

    btn.onclick = () => {
      result.textContent = '';
      result.classList.remove('error');

      const value = input.value.trim();
      if (!value) return;

      const out = formatJson(value);

      if (!out.ok) {
        result.textContent = out.error;
        result.classList.add('error');
        return;
      }

      result.textContent = out.formatted;
    };
  </script>
</BaseLayout>